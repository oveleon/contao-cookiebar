!function(){let e=function(){"use strict";return function(e){let t={},o={},n={selector:".contao-cookiebar",token:"ccb_contao_token",configId:null,pageId:null,hideOnInit:!1,blocking:!1,focusTrap:!0,version:null,lifetime:63072e3,consentLog:!1,cookies:null,configs:null,doNotTrack:!1,currentPageId:0,excludedPageIds:null,disableTracking:!1,texts:{acceptAndDisplay:"Accept"},classes:{onSave:"cc-saved",onShow:"cc-active",onGroupToggle:"cc-active",onGroupSplitSelection:"cc-group-half"}};const s=function(e){let t=[],n=e.currentTarget,s=0;n.hasAttribute("data-accept-all")?s=1:n.hasAttribute("data-deny-all")&&(s=2),L(!1),o.inputs.forEach(function(e){2===s?e.checked=!1:(1===s||e.checked)&&(t.push(parseInt(e.value)),e.checked=!0)}),D({configId:o.settings.configId,pageId:o.settings.pageId,version:o.settings.version,saved:R(),cookies:t}),r(t,!0),a(),l(),C(),t.length&&t.forEach(function(e){o.settings.cookies.hasOwnProperty("_"+e)&&"iframe"===o.settings.cookies["_"+e].type&&w(e),o.modules.hasOwnProperty("_"+e)&&v(e)}),o.dom.classList.add(o.settings.classes.onSave);let c=new CustomEvent("cookiebar_save",{detail:{cookiebar:o}});window.dispatchEvent(c),S(!0)},c=function(e){let t=F();t.cookies.includes(e)||(t.cookies.push(parseInt(e)),D(t),o.settings.cookies["_"+e].confirmed=!0,C())},i=function(){const e=Object.entries(o.settings.cookies??{}).sort(([,e],[,t])=>t.priority-e.priority);o.settings.cookies=Array.from(e).reduce((e,[t,o])=>Object.assign(e,{[`_${t}`]:o}),{})},r=function(e,t){let n=[];for(let s in o.settings.cookies){const c=parseInt(s.replace("_",""));if(!o.settings.cookies.hasOwnProperty(s))continue;let i=!!o.settings.cookies[s].confirmed,r=e.includes(c),a=i!==r&&!r;if(o.settings.cookies[s].confirmed=r,!0===t&&a){let e=o.settings.cookies[s].token;null!==e&&e.forEach(function(e){n.push(e)})}}if(!0===t&&n.length){let e=new XMLHttpRequest;e.open("POST","/cookiebar/delete",!0),e.send(q({tokens:n}))}},a=function(){let e;for(e in o.settings.configs){if(!o.settings.configs.hasOwnProperty(e))continue;let t=o.settings.configs[e];const n=Object.fromEntries(Object.entries(t.cookies).map(([e,t])=>[`_${e}`,t]));let s=p(n);null!==t.resources&&t.resources.forEach(function(e,o){if(1===e.mode&&s||2===e.mode&&!s||3===e.mode){if(g(h(t,o),"config_resource"))return;d(e)}}),null!==t.scripts&&t.scripts.forEach(function(e,o){if(1===e.mode===s||2===e.mode==!s||3===e.mode){if(g(h(t,o),"config_script"))return;u(e)}})}},l=function(){let e;for(e in o.settings.cookies){if(!o.settings.cookies.hasOwnProperty(e))continue;let t=o.settings.cookies[e];null!==t.resources&&t.resources.forEach(function(e,o){if(1===e.mode&&t.confirmed||2===e.mode&&!t.confirmed||3===e.mode){if(g(h(t,o),"resource"))return;d(e)}}),null!==t.scripts&&t.scripts.forEach(function(e,o){if(1===e.mode===t.confirmed||2===e.mode==!t.confirmed||3===e.mode){if(g(h(t,o),"script"))return;u(e)}})}},u=function(e){o.settings.disableTracking?m("Script execution was stopped."):(e.script=j(e.script),f(e.script,e.position))},d=function(e){if(o.settings.disableTracking)return void m("Adding a resource was stopped.");try{let t=document.querySelectorAll("script[src]"),o=M(e.src);for(let e=t.length;e--;)if(-1!==t[e].src.indexOf(o)&&o!==window.location.host)return!1}catch(e){}let t=document.createElement("script");t.type="text/javascript",t.nonce=document.querySelector("script[nonce]")?.nonce??null,t.src=e.src,t.onload=()=>{o.loadedResources.push(e.src),E()},null!==e.flags&&e.flags.length&&e.flags.forEach(function(e){"object"==typeof e?t.setAttribute(e[0],e[1]):t[e]=!0}),document.head.append(t)},f=function(e,t){switch(t){case 1:document.body.append(e);break;case 2:document.body.prepend(e);break;case 3:document.head.append(e)}},p=function(e){let t,n=!1;for(t in e){if(!o.settings.cookies.hasOwnProperty(t))continue;if(o.settings.cookies[t].confirmed){n=!0;break}}return n},g=function(e,t){return o.cache[t]||(o.cache[t]=[]),-1!==o.cache[t].indexOf(e)||(o.cache[t].push(e),!1)},h=function(e,t){return e.id+""+t},m=function(e){console.info("%cContao Cookiebar:","background: #fff09b; color: #222; padding: 3px","\n"+e)},k=function(){document.querySelectorAll("a.ccb-trigger, strong.ccb-trigger").forEach(function(e){b(e)}),new MutationObserver(function(e){for(const t of e)"childList"===t.type&&t.addedNodes.forEach(function(e){e.matches&&e.matches("a.ccb-trigger, strong.ccb-trigger")&&b(e)})}).observe(document,{attributes:!1,childList:!0,subtree:!0})},b=function(e){e.addEventListener("click",function(o){o.preventDefault(),t.show(e.classList.contains("ccb-prefill"))})},y=function(){let e=o.dom.querySelectorAll("[data-toggle-cookies]"),t=o.dom.querySelectorAll("[data-toggle-group]"),n=o.dom.querySelectorAll("[data-save],[data-accept-all],[data-deny-all]");n.length&&n.forEach(function(e){e.addEventListener("click",s)}),e.length&&e.forEach(function(e){e.addEventListener("click",N)}),t.length&&t.forEach(function(e){e.addEventListener("click",x)})},v=function(e){let t=document.querySelectorAll('.cc-module[data-ccb-id="'+e+'"]');t&&t.forEach(function(e){e.parentNode.removeChild(e)}),o.modules["_"+e].forEach(function(e){e()}),delete o.modules["_"+e],S()},E=function(){if(!o.resourcesEvents.length)return!1;o.resourcesEvents.forEach(function(e,t){if(-1===o.loadedResources.indexOf(e.src))return!1;e.callback(),delete o.resourcesEvents[t]})},w=function(e){let t=document.querySelectorAll('iframe[data-ccb-id="'+e+'"]');t.length&&t.forEach(function(e){e.src=e.src,e.removeAttribute("data-ccb-id")}),S()},S=function(e){let t=F(),n=[];if(!o.show&&!0!==e)return;if(t.cookies&&t.cookies.length)n=t.cookies;else if(-1===t.version)for(let e in o.settings.cookies){const t=parseInt(e.replace("_",""));o.settings.cookies[e].checked&&n.push(t)}n.length&&n.forEach(function(e,t){let n=o.dom.querySelector('[id="c'+e+'"]');n&&(n.checked=!0)});let s=o.dom.querySelectorAll('input[name="group[]"]');s&&s.forEach(function(e){if(e.disabled)return;e.checked=!1,e.classList.remove(o.settings.classes.onGroupSplitSelection);let t=e.parentElement.querySelectorAll('input[name="cookie[]"]'),n=[];t&&(t.forEach(function(e){e.disabled||n.push(!!e.checked)}),-1===n.indexOf(!1)?e.checked=!0:-1!==n.indexOf(!0)&&-1!==n.indexOf(!1)&&e.classList.add(o.settings.classes.onGroupSplitSelection))})},O=function(){const e=o.dom.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), input[type="checkbox"]:not([disabled])');o.toggleOpener=o.dom.querySelector("[data-ft-opener]"),o.firstFocus=e[0],o.lastFocus=e[e.length-1]},I=function(e){"Tab"!==e.key&&9!==e.keyCode||(o.focused||(o.focused=!0,o.firstFocus?.classList.remove("cc-hide-focus")),document.activeElement!==o.lastFocus||e.shiftKey||(e.preventDefault(),o.firstFocus?.focus()),document.activeElement===o.firstFocus&&e.shiftKey&&(e.preventDefault(),o.lastFocus?.focus()),document.activeElement!==o.toggleOpener||function(e){for(;e;){if("none"===window.getComputedStyle(e).display)return!1;e=e.parentElement}return!0}(o.lastFocus)||"false"!==o.toggleOpener.ariaExpanded||e.shiftKey||(e.preventDefault(),o.firstFocus?.focus()))},L=function(e){o.settings.blocking&&o.dom?.parentElement.querySelectorAll(":scope >:not(script):not(.contao-cookiebar)")?.forEach(t=>{e?t.setAttribute("inert",""):t.removeAttribute("inert")}),o.settings.focusTrap&&(e?(document.addEventListener("keydown",I),o.dom.querySelector(".cc-inner").onanimationend=()=>{o.focused=!1,o.firstFocus?.classList.add("cc-hide-focus"),o.firstFocus?.focus({preventScroll:!0})}):document.removeEventListener("keydown",I))},A=function(){new MutationObserver(e=>{for(const t of e)"childList"===t.type&&t.addedNodes.length>0&&t.addedNodes.forEach(e=>{!o.show||e.nodeType!==Node.ELEMENT_NODE||e.classList.contains(".contao-cookiebar")||e.hasAttribute("inert")||e.setAttribute("inert","")})}).observe(o.dom,{childList:!0,subtree:!1})},T=function(){o.show?(o.dom.classList.remove(o.settings.classes.onSave),o.dom.classList.add(o.settings.classes.onShow),L(!0)):(o.dom.classList.remove(o.settings.classes.onShow),L(!1))},N=function(){let e=this.checked,t=this.parentElement.querySelectorAll('input[name="cookie[]"]');t&&t.forEach(function(t,o){t.disabled||(t.checked=e)}),this.classList.remove(o.settings.classes.onGroupSplitSelection)},x=function(){let e=!this.classList.contains(o.settings.classes.onGroupToggle);this.setAttribute("aria-expanded",e?"true":"false");try{let t=this.parentElement.querySelectorAll(":scope > .toggle-group");t&&t.forEach(function(t,o){t.style.display=e?"block":"none"})}catch(t){this.parentElement.querySelector("[data-toggle-group] ~ .toggle-group").style.display=e?"block":"none"}this.classList.toggle(o.settings.classes.onGroupToggle)},C=function(){if(!o.settings.consentLog)return;let e=new XMLHttpRequest,t={referrer:window.location.pathname,configId:o.settings.configId,pageId:o.settings.pageId,cookies:F().cookies};e.open("GET","/cookiebar/log?"+q(t),!0),e.send()},q=function(e,t){let o,n=[];for(o in e)if(e.hasOwnProperty(o)){let s=t?t+"["+o+"]":o,c=e[o];n.push(null!==c&&"object"==typeof c?q(c,s):encodeURIComponent(s)+"="+encodeURIComponent(c))}return n.join("&")},P=function(){let e={},t=!1,o=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],o++);let s=function(o){for(let n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t&&"[object Object]"===Object.prototype.toString.call(o[n])?e[n]=P(!0,e[n],o[n]):e[n]=o[n])};for(;o<n;o++){s(arguments[o])}return e},_=function(){return o.settings.token+"_"+o.settings.configId},j=function(e){let t=document.createElement("script");return t.type="text/javascript",t.nonce=document.querySelector("script[nonce]")?.nonce??null,t.innerHTML=e,t},D=function(e){localStorage.setItem(_(),JSON.stringify(e))},F=function(){let e=localStorage.getItem(_());return null===e?(e={configId:o.settings.configId,pageId:o.settings.pageId,version:-1,saved:-1,cookies:[]},localStorage.setItem(_(),JSON.stringify(e))):e=JSON.parse(e),e},M=function(e){let t=e.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);return t&&t[1]},R=function(){return Math.floor(+new Date/1e3)},G=function(){return!(o.settings.currentPageId&&o.settings.excludedPageIds&&-1!==o.settings.excludedPageIds.indexOf(o.settings.currentPageId))},H=function(){return!o.settings.doNotTrack||(!(window.doNotTrack||navigator.doNotTrack||navigator.msDoNotTrack)||!("1"==window.doNotTrack||"yes"==navigator.doNotTrack||"1"==navigator.doNotTrack||"1"==navigator.msDoNotTrack))},$=function(e){let t=parseInt(e),n=parseInt(o.settings.lifetime);return!isNaN(t)&&-1!==t&&0!==n&&t+n<R()};return t.get=function(){return o},t.getStorage=function(){return F()},t.issetCookie=function(e){let t,n=F();if(!n.cookies)return!1;if("number"==typeof e)return-1!==n.cookies.indexOf(e);for(t in o.settings.cookies)if(null!==o.settings.cookies[t].token&&-1!==o.settings.cookies[t].token.indexOf(e))return-1!==n.cookies.indexOf(o.settings.cookies[t].id);return-1!==n.cookies.indexOf(e.toString())},t.unblock=function(e,t,o){"iframe"===e.tagName.toLowerCase()?e.src=o:e.tagName.toLowerCase()&&(window.location.href=o),c(t),w(t)},t.addModule=function(e,n,s){if(function(e,t){o.modules.hasOwnProperty("_"+e)?o.modules["_"+e].push(t):o.modules["_"+e]=[t]}(e,n),t.issetCookie(e))return v(e),!1;if(s&&"object"==typeof s&&s.selector){let t=null;if(t="string"==typeof s.selector?document.querySelector(s.selector):s.selector,t){let n=document.createElement("div");if(n.setAttribute("data-ccb-id",e),n.classList.add("cc-module"),s.message&&(n.innerHTML="<p>"+s.message+"</p>"),"object"==typeof s.button&&!0===s.button.show){var i=document.createElement("button");i.innerHTML=s.button.text||o.settings.texts.acceptAndDisplay,i.type=s.button.type||"button",s.button.classes&&(i.className=s.button.classes),i.addEventListener("click",function(){c(e),v(e)}),n.append(i)}t.appendChild(n)}}},t.onResourceLoaded=function(e,t){if(!o.settings.cookies.hasOwnProperty(e))return m.warn(`Cookie ID ${e} does not exists.`),!1;if(!o.settings.cookies[e].resources.length)return m.warn(`The cookie ID ${e} does not contain any resources.`),!1;const n=o.settings.cookies[e].resources[0].src;-1!==o.loadedResources.indexOf(n)?t():o.resourcesEvents.push({src:n,callback:t})},t.show=function(e){o.show=!0,T(),e&&S()},t.hide=function(){o.show=!1,T()},window.document.documentMode&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){var o=e instanceof Node;t.appendChild(o?e:document.createTextNode(String(e)))}),this.appendChild(t)}})}),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){var o=e instanceof Node;t.appendChild(o?e:document.createTextNode(String(e)))}),this.insertBefore(t,this.firstChild)}})}),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}e.prototype=window.Event.prototype,window.CustomEvent=e}()),function(){o.settings=P(!0,n,e),o.dom=document.querySelector(o.settings.selector),o.cache={},o.modules={},o.loadedResources=[],o.resourcesEvents=[],o.show=!1;let t=F();!o.settings.hideOnInit&&(parseInt(t.version)!==parseInt(o.settings.version)||parseInt(t.configId)!==parseInt(o.settings.configId)||$(t.saved))&&H()&&G()&&(o.show=!0),o.inputs=[],o.dom.querySelectorAll('input[name="cookie[]"]').forEach(function(e,t){e.disabled||o.inputs.push(e)}),o.settings.disableTracking&&m("The execution of scripts is prevented. Please log out of the backend to test scripts, or disable the setting within the cookiebar config."),y(),k(),o.settings.focusTrap&&O(),o.settings.blocking&&A(),i(),r(t.cookies),T(),a(),l(),S();let s=new CustomEvent("cookiebar_init",{detail:{visibility:o.show,cookiebar:o}});window.dispatchEvent(s)}(),t}}();window.ContaoCookiebar=e}();